import{r as N,j as e}from"./react-fsc5c2Qp.js";import{u as h,S as O,a as P,s as B}from"./index-YfD6aeVd.js";import{P as k,T as g,B as j,ab as n,a as i,f as c,D as v,F,ac as M,k as E,l as S,m as I,ad as q,ae as A,af as D,ag as z,b as _}from"./mui-B26OF-U5.js";const U=({onSubmit:W,initialValues:o={}})=>{const[r,b]=N.useState({cafeId:o.cafeId||"",cafeName:o.cafeName||"",cafeNeighborhood:o.cafeNeighborhood||"",coffeeRoaster:o.coffeeRoaster||"",coffeeOrigin:o.coffeeOrigin||"",coffeeOriginRegion:o.coffeeOriginRegion||"",brewMethod:o.brewMethod||"",tastingNotes:o.tastingNotes||[],acidity:o.acidity||"",mouthFeel:o.mouthFeel||"",roastLevel:o.roastLevel||"",rating:o.rating||3,notes:o.notes||"",isPublic:o.isPublic!==void 0?o.isPublic:!0,coffeeName:o.coffeeName||""}),m=h(t=>t.cafes),C=h(t=>t.setCafes),u=h(t=>t.options),y=h(t=>t.setOptions),f=h(t=>t.fetchError),d=h(t=>t.setFetchError);N.useEffect(()=>{const t=async()=>{try{const a=await P("/metadata/form-options");C(a.cafes||[]),y(a.enums||{})}catch(a){console.error("Error fetching metadata:",a),d(""),B({title:"We couldn't load form options",text:"We couldn't reach the server. Please try again.",icon:"error"})}};(!m||m.length===0)&&t()},[C,y,d,m]);const s=t=>{const{name:a,value:l,type:x,checked:p}=t.target;b(R=>({...R,[a]:x==="checkbox"?p:l})),f&&d("")},L=t=>{const{value:a,checked:l}=t.target;b(x=>({...x,tastingNotes:l?[...x.tastingNotes,a]:x.tastingNotes.filter(p=>p!==a)})),f&&d("")},T=t=>{const a=m.find(l=>l._id===t.target.value);b(l=>({...l,cafeId:t.target.value,cafeNeighborhood:a?a.neighborhood:""})),f&&d("")},w=async t=>{if(t.preventDefault(),r.tastingNotes.length===0){d("Please select at least one tasting note.");return}W(r)};return e.jsxs(k,{elevation:2,sx:{p:3,mb:4,"& .MuiTextField-root":{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{}},"& .MuiInputLabel-root.Mui-focused":{}},"& .MuiCheckbox-root.Mui-checked":{}},children:[e.jsx(g,{variant:"h5",component:"h2",gutterBottom:!0,children:o.cafeId?"Edit Coffee Tasting":"Add New Coffee Tasting"}),e.jsxs("form",{onSubmit:w,children:[f&&e.jsx(O,{message:f,type:"error"}),e.jsxs(j,{sx:{mb:3},children:[e.jsx(g,{variant:"h6",gutterBottom:!0,children:"Coffee Information"}),e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(i,{label:"Coffee Name",name:"coffeeName",value:r.coffeeName,onChange:s,required:!0,fullWidth:!0,margin:"normal"})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(i,{select:!0,label:"Where did you taste this coffee?",name:"cafeId",value:r.cafeId,onChange:T,required:!0,fullWidth:!0,margin:"normal",children:[e.jsx(c,{value:"",children:"Select a cafe"}),m.map(t=>e.jsx(c,{value:t._id,children:t.name},t._id))]})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(i,{label:"Coffee Roaster",name:"coffeeRoaster",value:r.coffeeRoaster,onChange:s,fullWidth:!0,margin:"normal"})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(i,{label:"Coffee Origin",name:"coffeeOrigin",value:r.coffeeOrigin,onChange:s,fullWidth:!0,margin:"normal"})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(i,{label:"Coffee Region",name:"coffeeOriginRegion",value:r.coffeeOriginRegion,onChange:s,fullWidth:!0,margin:"normal"})})]})]}),e.jsx(v,{sx:{my:3}}),e.jsxs(j,{sx:{mb:3},children:[e.jsx(g,{variant:"h6",gutterBottom:!0,children:"Brewing Information"}),e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(i,{select:!0,label:"Brew Method",name:"brewMethod",value:r.brewMethod,onChange:s,required:!0,fullWidth:!0,margin:"normal",children:[e.jsx(c,{value:"",children:"Select"}),(u.brewMethod||[]).map(t=>e.jsx(c,{value:t,children:t},t))]})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(i,{select:!0,label:"Roast Level",name:"roastLevel",value:r.roastLevel,onChange:s,required:!0,fullWidth:!0,margin:"normal",children:[e.jsx(c,{value:"",children:"Select"}),(u.roastLevel||[]).map(t=>e.jsx(c,{value:t,children:t},t))]})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(i,{select:!0,label:"Acidity",name:"acidity",value:r.acidity,onChange:s,required:!0,fullWidth:!0,margin:"normal",children:[e.jsx(c,{value:"",children:"Select"}),(u.acidity||[]).map(t=>e.jsx(c,{value:t,children:t},t))]})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(i,{select:!0,label:"Mouth Feel",name:"mouthFeel",value:r.mouthFeel,onChange:s,required:!0,fullWidth:!0,margin:"normal",children:[e.jsx(c,{value:"",children:"Select"}),(u.mouthFeel||[]).map(t=>e.jsx(c,{value:t,children:t},t))]})})]})]}),e.jsx(v,{sx:{my:3}}),e.jsxs(j,{sx:{mb:3},children:[e.jsx(g,{variant:"h6",gutterBottom:!0,children:"Tasting Experience"}),e.jsxs(F,{fullWidth:!0,margin:"normal",required:!0,sx:{mb:2,"& .MuiFormLabel-root":{},"& .MuiFormLabel-root.Mui-focused":{}},children:[e.jsx(M,{component:"legend",children:"Tasting Notes (Select at least one)"}),e.jsx(E,{row:!0,children:(u.tastingNotes||[]).map(t=>e.jsx(S,{control:e.jsx(I,{name:"tastingNotes",value:t,checked:r.tastingNotes.includes(t),onChange:L}),label:t,sx:{minWidth:"200px",mb:1}},t))})]}),e.jsxs(F,{margin:"normal",sx:{mb:2,"& .MuiFormLabel-root":{color:"text.primary"},"& .MuiFormLabel-root.Mui-focused":{color:"text.primary"}},children:[e.jsx(M,{component:"legend",children:"Overall Rating"}),e.jsx(q,{name:"rating",value:r.rating,precision:.5,max:5,icon:e.jsx(D,{fontSize:"inherit"}),emptyIcon:e.jsx(A,{fontSize:"inherit"}),onChange:(t,a)=>b(l=>({...l,rating:a||1})),sx:{mt:1}}),e.jsx(z,{children:r.rating?`${r.rating} out of 5 hearts`:"Select your rating"})]}),e.jsx(i,{label:"Additional Notes",name:"notes",value:r.notes,onChange:s,multiline:!0,rows:4,fullWidth:!0,margin:"normal",inputProps:{maxLength:500},placeholder:"Share your thoughts about this coffee experience...",helperText:`${r.notes.length}/500 characters`})]}),e.jsx(v,{sx:{my:3}}),e.jsxs(j,{sx:{mb:3},children:[e.jsx(g,{variant:"h6",gutterBottom:!0,children:"Privacy Settings"}),e.jsx(S,{control:e.jsx(I,{id:"isPublic",name:"isPublic",checked:r.isPublic,onChange:s}),label:"Make this tasting public (visible to other users)"})]}),e.jsx(j,{sx:{mt:4,textAlign:"center"},children:e.jsx(_,{type:"submit",variant:"contained",size:"large",sx:{minWidth:200,py:1.5},disabled:!r.cafeId||!r.coffeeName||!r.brewMethod||!r.roastLevel||r.tastingNotes.length===0,children:o.cafeId?"Update Tasting":"Add Tasting"})})]})]})};export{U as T};
