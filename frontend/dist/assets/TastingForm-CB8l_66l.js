import{r as N,j as e}from"./react-D15UzJOD.js";import{u as h,S as E,a as P,s as B}from"./index-BE1ZWYQH.js";import{w as z,P as b,a as j,B as y,G as o,y as m,p as d,H as S,aj as F,b as D,ae as q,ak as A,al as H,am as _,Q as G,U as R,W as M,l as U,E as $}from"./mui-_CYUd7UL.js";const J=({onSubmit:k,initialValues:s={}})=>{const r=z(),l={"& .MuiOutlinedInput-root":{backgroundColor:r.palette.common.white,minHeight:{xs:56,sm:48},"& fieldset":{borderColor:r.palette.text.primary},"&:hover fieldset":{borderColor:r.palette.primary.main},"&.Mui-focused fieldset":{borderColor:r.palette.primary.main},"& input":{color:r.palette.text.primary,fontSize:{xs:"16px",sm:"14px"}},"& textarea":{color:r.palette.text.primary,fontSize:{xs:"16px",sm:"14px"}}},"& .MuiInputLabel-root":{color:r.palette.text.primary,"&.Mui-focused":{color:r.palette.primary.main}}},[a,v]=N.useState({cafeId:s.cafeId||"",cafeName:s.cafeName||"",cafeNeighborhood:s.cafeNeighborhood||"",coffeeRoaster:s.coffeeRoaster||"",coffeeOrigin:s.coffeeOrigin||"",coffeeOriginRegion:s.coffeeOriginRegion||"",brewMethod:s.brewMethod||"",tastingNotes:s.tastingNotes||[],acidity:s.acidity||"",mouthFeel:s.mouthFeel||"",roastLevel:s.roastLevel||"",rating:s.rating||3,notes:s.notes||"",isPublic:s.isPublic!==void 0?s.isPublic:!0,coffeeName:s.coffeeName||""}),u=h(t=>t.cafes),W=h(t=>t.setCafes),g=h(t=>t.options),w=h(t=>t.setOptions),f=h(t=>t.fetchError),x=h(t=>t.setFetchError);N.useEffect(()=>{const t=async()=>{var n;try{const i=await P("/metadata/form-options");W(i.cafes||[]),w(i.enums||{})}catch(i){console.error("Error fetching metadata:",i),i.code==="NETWORK_ERROR"||(n=i.message)!=null&&n.includes("fetch")||!i.response?B({title:"Server Unavailable",text:"We couldn't reach the server. Please try again later.",icon:"error"}):x("We couldn't load form options. Please try again.")}};(!u||u.length===0)&&t()},[W,w,x,u]);const c=t=>{const{name:n,value:i,type:p,checked:C}=t.target;v(O=>({...O,[n]:p==="checkbox"?C:i})),f&&x("")},I=t=>{const{value:n,checked:i}=t.target;v(p=>({...p,tastingNotes:i?[...p.tastingNotes,n]:p.tastingNotes.filter(C=>C!==n)})),f&&x("")},T=t=>{const n=u.find(i=>i._id===t.target.value);v(i=>({...i,cafeId:t.target.value,cafeNeighborhood:n?n.neighborhood:""})),f&&x("")},L=async t=>{if(t.preventDefault(),a.tastingNotes.length===0){x("Please select at least one tasting note.");return}k(a)};return e.jsxs(b,{elevation:2,sx:{width:{xs:"100%",sm:640,md:900,lg:1e3},maxWidth:{xs:"none",sm:640,md:900,lg:1e3},p:{xs:2,sm:3},mb:4,display:"flex",flexDirection:"column",gap:2,backgroundColor:r.palette.light.main,borderRadius:2,boxShadow:3,color:r.palette.text.primary,position:"relative",zIndex:1,overflow:"hidden",minHeight:"auto"},children:[e.jsx(j,{variant:"h4",component:"h2",gutterBottom:!0,sx:{color:r.palette.text.primary,fontSize:{xs:"1.5rem",sm:"2rem"},mb:2},children:s.cafeId?"Edit Coffee Tasting":"Add New Coffee Tasting"}),e.jsxs("form",{onSubmit:L,children:[f&&e.jsx(E,{message:f,type:"error"}),e.jsxs(y,{sx:{display:"flex",flexDirection:{xs:"column",lg:"row"},gap:3,alignItems:"flex-start"},children:[e.jsx(y,{sx:{flex:1,display:"flex",flexDirection:"column",gap:3},children:e.jsxs(b,{elevation:1,sx:{p:3,backgroundColor:"rgba(255, 255, 255, 0.8)"},children:[e.jsx(j,{variant:"h6",gutterBottom:!0,sx:{color:r.palette.primary.main,fontWeight:600,mb:2},children:"Coffee Information"}),e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,sm:6,md:6,lg:4,children:e.jsx(m,{label:"Coffee Name",name:"coffeeName",value:a.coffeeName,onChange:c,required:!0,fullWidth:!0,margin:"normal",sx:l})}),e.jsx(o,{item:!0,xs:12,sm:6,md:6,lg:4,children:e.jsxs(m,{select:!0,label:"Where did you taste this coffee?",name:"cafeId",value:a.cafeId,onChange:T,required:!0,fullWidth:!0,margin:"normal",sx:l,children:[e.jsx(d,{value:"",children:"Select a cafe"}),u.map(t=>e.jsx(d,{value:t._id,children:t.name},t._id))]})}),e.jsx(o,{item:!0,xs:12,sm:6,md:6,lg:4,children:e.jsx(m,{label:"Coffee Roaster",name:"coffeeRoaster",value:a.coffeeRoaster,onChange:c,fullWidth:!0,margin:"normal",sx:l})}),e.jsx(o,{item:!0,xs:12,sm:6,md:6,lg:4,children:e.jsx(m,{label:"Coffee Origin",name:"coffeeOrigin",value:a.coffeeOrigin,onChange:c,fullWidth:!0,margin:"normal",sx:l})}),e.jsx(o,{item:!0,xs:12,sm:6,md:6,lg:4,children:e.jsx(m,{label:"Coffee Region",name:"coffeeOriginRegion",value:a.coffeeOriginRegion,onChange:c,fullWidth:!0,margin:"normal",sx:l})}),e.jsxs(o,{item:!0,xs:12,sm:6,md:6,lg:4,children:[e.jsx("div",{})," "]})]})]})}),e.jsx(y,{sx:{flex:1,display:"flex",flexDirection:"column",gap:3},children:e.jsxs(b,{elevation:1,sx:{p:3,backgroundColor:"rgba(255, 255, 255, 0.8)"},children:[e.jsx(j,{variant:"h6",gutterBottom:!0,sx:{color:r.palette.primary.main,fontWeight:600,mb:2},children:"Brewing Method & Profile"}),e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,sm:6,md:6,lg:3,children:e.jsxs(m,{select:!0,label:"Brew Method",name:"brewMethod",value:a.brewMethod,onChange:c,required:!0,fullWidth:!0,margin:"normal",sx:l,children:[e.jsx(d,{value:"",children:"Select"}),(g.brewMethod||[]).map(t=>e.jsx(d,{value:t,children:t},t))]})}),e.jsx(o,{item:!0,xs:12,sm:6,md:6,lg:3,children:e.jsxs(m,{select:!0,label:"Roast Level",name:"roastLevel",value:a.roastLevel,onChange:c,required:!0,fullWidth:!0,margin:"normal",sx:l,children:[e.jsx(d,{value:"",children:"Select"}),(g.roastLevel||[]).map(t=>e.jsx(d,{value:t,children:t},t))]})}),e.jsx(o,{item:!0,xs:12,sm:6,md:6,lg:3,children:e.jsxs(m,{select:!0,label:"Acidity",name:"acidity",value:a.acidity,onChange:c,required:!0,fullWidth:!0,margin:"normal",sx:l,children:[e.jsx(d,{value:"",children:"Select"}),(g.acidity||[]).map(t=>e.jsx(d,{value:t,children:t},t))]})}),e.jsx(o,{item:!0,xs:12,sm:6,md:6,lg:3,children:e.jsxs(m,{select:!0,label:"Mouth Feel",name:"mouthFeel",value:a.mouthFeel,onChange:c,required:!0,fullWidth:!0,margin:"normal",sx:l,children:[e.jsx(d,{value:"",children:"Select"}),(g.mouthFeel||[]).map(t=>e.jsx(d,{value:t,children:t},t))]})}),e.jsx(o,{item:!0,xs:12,children:e.jsxs(S,{margin:"normal",sx:{mt:2,"& .MuiFormLabel-root":{color:r.palette.text.primary},"& .MuiFormLabel-root.Mui-focused":{color:r.palette.text.primary}},children:[e.jsx(F,{component:"legend",sx:{fontWeight:600,mb:1},children:"Overall Rating"}),e.jsx(D,{title:"Rate your overall coffee experience from 1-5 hearts",arrow:!0,placement:"top",children:e.jsx(q,{name:"rating",value:a.rating,precision:.5,max:5,icon:e.jsx(H,{fontSize:"inherit"}),emptyIcon:e.jsx(A,{fontSize:"inherit"}),onChange:(t,n)=>v(i=>({...i,rating:n||1})),sx:{mt:1,"& .MuiRating-iconFilled":{color:r.palette.accent.main},"& .MuiRating-iconEmpty":{color:"rgba(0, 0, 0, 0.26)"}}})}),e.jsx(_,{children:a.rating?`${a.rating} out of 5 hearts`:"Select your rating"})]})})]})]})})]}),e.jsxs(y,{sx:{mt:3},children:[e.jsxs(b,{elevation:1,sx:{p:3,mb:3,backgroundColor:"rgba(255, 255, 255, 0.8)"},children:[e.jsx(j,{variant:"h6",gutterBottom:!0,sx:{color:r.palette.primary.main,fontWeight:600,mb:2},children:"Tasting Experience & Notes"}),e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,children:e.jsxs(S,{fullWidth:!0,margin:"normal",required:!0,sx:{mb:2,"& .MuiFormLabel-root":{color:r.palette.text.primary},"& .MuiFormLabel-root.Mui-focused":{color:r.palette.text.primary}},children:[e.jsx(F,{component:"legend",sx:{fontWeight:600,mb:1},children:"Tasting Notes (Select at least one)"}),e.jsx(G,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:1.5,justifyContent:"flex-start",width:"100%"},children:(g.tastingNotes||[]).map(t=>e.jsx(R,{control:e.jsx(M,{name:"tastingNotes",value:t,checked:a.tastingNotes.includes(t),onChange:I,sx:{color:r.palette.primary.main}}),label:t,sx:{minWidth:"180px",maxWidth:"calc(25% - 12px)",mb:1,backgroundColor:"rgba(255, 255, 255, 0.5)",borderRadius:1,px:1,mr:0,flex:"1 1 auto","@media (max-width: 900px)":{maxWidth:"calc(33.333% - 12px)"},"@media (max-width: 600px)":{maxWidth:"calc(50% - 12px)"}}},t))})]})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(m,{label:"Additional Notes",name:"notes",value:a.notes,onChange:c,multiline:!0,rows:4,fullWidth:!0,margin:"normal",inputProps:{maxLength:500},placeholder:"Share your thoughts about this coffee experience...",helperText:`${a.notes.length}/500 characters`,sx:l})})]})]}),e.jsx(U,{sx:{my:3}}),e.jsx(b,{elevation:1,sx:{p:3,mb:3,backgroundColor:"rgba(255, 255, 255, 0.8)"},children:e.jsxs(o,{container:!0,spacing:3,alignItems:"center",children:[e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx(j,{variant:"h6",gutterBottom:!0,sx:{color:r.palette.primary.main,fontWeight:600,mb:2},children:"Privacy Settings"}),e.jsx(R,{control:e.jsx(M,{id:"isPublic",name:"isPublic",checked:a.isPublic,onChange:c,sx:{color:r.palette.primary.main}}),label:"Make this tasting public (visible to other users)",sx:{backgroundColor:"rgba(255, 255, 255, 0.5)",borderRadius:1,px:2,py:1,mr:1}})]}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(y,{sx:{textAlign:{xs:"center",md:"right"}},children:e.jsx($,{type:"submit",variant:"contained",color:"primary",size:"large",sx:{minWidth:200,py:{xs:1.5,sm:1.5},px:{xs:2,sm:3},minHeight:{xs:48,sm:42},fontSize:{xs:"16px",sm:"14px"},backgroundColor:r.palette.primary.main,color:r.palette.primary.contrastText,boxShadow:3,"&:hover":{backgroundColor:r.palette.primary.dark,transform:"translateY(-2px)",boxShadow:6},"&:disabled":{backgroundColor:r.palette.action.disabled,color:r.palette.text.disabled}},disabled:!a.cafeId||!a.coffeeName||!a.brewMethod||!a.roastLevel||a.tastingNotes.length===0,children:s.cafeId?"Update Tasting":"Add Tasting"})})})]})})]})]})]})};export{J as T};
