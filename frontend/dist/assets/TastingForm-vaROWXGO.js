import{a as N,u as n,j as t,d as L}from"./index-BO2DIhwT.js";import{S as I}from"./SwalAlertStyles-y8bx9c-9.js";const M=({onSubmit:F,initialValues:o={}})=>{var p,v,j,C;const[c,h]=N.useState({cafeId:o.cafeId||"",cafeName:o.cafeName||"",cafeNeighborhood:o.cafeNeighborhood||"",coffeeRoaster:o.coffeeRoaster||"",coffeeOrigin:o.coffeeOrigin||"",coffeeOriginRegion:o.coffeeOriginRegion||"",brewMethod:o.brewMethod||"",tastingNotes:o.tastingNotes||[],acidity:o.acidity||"",mouthFeel:o.mouthFeel||"",roastLevel:o.roastLevel||"",rating:o.rating||3,notes:o.notes||"",isPublic:o.isPublic!==void 0?o.isPublic:!0,coffeeName:o.coffeeName||""}),i=n(e=>e.cafes),m=n(e=>e.setCafes),r=n(e=>e.options),u=n(e=>e.setOptions),f=n(e=>e.fetchError),l=n(e=>e.setFetchError);n(e=>e.user),N.useEffect(()=>{const e=async()=>{try{const a=await L("/metadata/form-options");m(a.cafes||[]),u(a.enums||{})}catch(a){console.error("Error fetching metadata:",a),l("Failed to load metadata")}};(!i||i.length===0)&&e()},[m,u,l,i]);const x=e=>{const{name:a,value:s,type:d,checked:g}=e.target;h(O=>({...O,[a]:d==="checkbox"?g:s})),f&&l("")},y=e=>{const{value:a,checked:s}=e.target;h(d=>({...d,tastingNotes:s?[...d.tastingNotes,a]:d.tastingNotes.filter(g=>g!==a)})),f&&l("")},b=e=>{const a=i.find(s=>s._id===e.target.value);h(s=>({...s,cafeId:e.target.value,cafeNeighborhood:a?a.neighborhood:""}))},R=e=>{if(e.preventDefault(),c.tastingNotes.length===0){l("Please select at least one tasting note.");return}F(c)};return t.jsxs("form",{onSubmit:R,children:[f&&t.jsx(I,{message:f,type:"error"}),t.jsxs("label",{htmlFor:"coffeeName",children:["Coffee Name:",t.jsx("input",{type:"text",id:"coffeeName",name:"coffeeName",value:c.coffeeName,onChange:x,required:!0})]}),t.jsxs("label",{htmlFor:"cafeId",children:["Where did you taste this coffee?:",t.jsxs("select",{id:"cafeId",name:"cafeId",value:cafeId,onChange:b,required:!0,children:[t.jsx("option",{value:"",children:"Select Cafe"}),i.map(e=>t.jsx("option",{value:e._id,children:e.name},e._id))]})]}),t.jsxs("label",{htmlFor:"coffeeRoaster",children:["Coffee Roaster:",t.jsx("input",{type:"text",id:"coffeeRoaster",name:"coffeeRoaster",value:coffeeRoaster,onChange:e=>setCoffeeRoaster(e.target.value)})]}),t.jsxs("label",{htmlFor:"coffeeOrigin",children:["Coffee Origin:",t.jsx("input",{type:"text",id:"coffeeOrigin",name:"coffeeOrigin",value:coffeeOrigin,onChange:e=>setCoffeeOrigin(e.target.value)})]}),t.jsxs("label",{htmlFor:"coffeeOriginRegion",children:["Coffee Region:",t.jsx("input",{type:"text",id:"coffeeOriginRegion",name:"coffeeOriginRegion",value:coffeeOriginRegion,onChange:e=>setCoffeeOriginRegion(e.target.value)})]}),t.jsxs("label",{htmlFor:"brewMethod",children:["Brew Method:",t.jsxs("select",{id:"brewMethod",name:"brewMethod",value:brewMethod,onChange:e=>setBrewMethod(e.target.value),required:!0,children:[t.jsx("option",{value:"",children:"Select"}),(p=r.brewMethod)==null?void 0:p.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsxs("label",{htmlFor:"roastLevel",children:["Roast Level:",t.jsx("input",{type:"range",id:"roastLevel",name:"roastLevel",min:"0",max:(v=r.roastLevel)!=null&&v.length?r.roastLevel.length-1:2,value:Math.max(((j=r.roastLevel)==null?void 0:j.indexOf(roastLevel))??0,0),onChange:e=>{var a;return setRoastLevel(((a=r.roastLevel)==null?void 0:a[e.target.value])||"")},required:!0}),t.jsx("span",{style:{marginLeft:"1rem"},children:roastLevel||"Select"})]}),t.jsxs("fieldset",{children:[t.jsx("legend",{children:"Tasting Notes (choose multiple):"}),(r.tastingNotes||[]).map(e=>t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",name:"tastingNotes",value:e,checked:tastingNotes.includes(e),onChange:y}),e]},e))]}),t.jsxs("label",{htmlFor:"cafeId",children:["Where did you taste this coffee?:",t.jsxs("select",{id:"cafeId",name:"cafeId",value:c.cafeId,onChange:b,required:!0,children:[t.jsx("option",{value:"",children:"Select a cafe"}),i.map(e=>t.jsx("option",{value:e._id,children:e.name},e._id))]})]}),t.jsxs("label",{htmlFor:"mouthFeel",children:["Mouth Feel:",t.jsxs("select",{id:"mouthFeel",name:"mouthFeel",value:c.mouthFeel,onChange:x,required:!0,children:[t.jsx("option",{value:"",children:"Select"}),(C=r.mouthFeel)==null?void 0:C.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsxs("label",{htmlFor:"rating",children:["Rating (1-5):",t.jsx("input",{type:"range",id:"rating",name:"rating",min:"1",max:"5",value:rating,onChange:e=>setRating(Number(e.target.value)),required:!0}),t.jsx("span",{style:{marginLeft:"1rem"},children:rating})]}),t.jsxs("label",{labelhtmlFor:"notes",children:["Notes:",t.jsx("textarea",{id:"notes",name:"notes",value:notes,onChange:e=>setNotes(e.target.value),maxLength:500,placeholder:"Additional notes about the tasting"})]}),t.jsxs("label",{htmlFor:"isPublic",children:["Public:",t.jsx("input",{type:"checkbox",id:"isPublic",name:"isPublic",checked:isPublic,onChange:e=>setIsPublic(e.target.checked)})]}),t.jsx("button",{style:{marginTop:"1rem",backgroundColor:"#170351",color:"#fff",padding:"0.5rem 1rem",border:"none",cursor:"pointer"},type:"submit",disabled:!cafeId||!coffeeName||!brewMethod||!roastLevel,children:"Submit"})]})};export{M as T};
