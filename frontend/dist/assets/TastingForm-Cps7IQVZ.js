import{j as t,r as L}from"./react-BtMNIPra.js";import{u as c,a as P}from"./index-wWVfeLJl.js";import"./vendor-CyRx9_Ke.js";import{A as E,g as s,e as m,$ as x,a0 as j,a1 as p,a2 as k,a3 as y,a4 as R,a5 as W,a6 as T,a7 as q,h as A}from"./mui-7-yASJkv.js";const z=({message:v,type:r="info"})=>t.jsx(E,{severity:r,sx:{my:2},children:v}),H=({onSubmit:v,initialValues:r={}})=>{var F,S;const[a,h]=L.useState({cafeId:r.cafeId||"",cafeName:r.cafeName||"",cafeNeighborhood:r.cafeNeighborhood||"",coffeeRoaster:r.coffeeRoaster||"",coffeeOrigin:r.coffeeOrigin||"",coffeeOriginRegion:r.coffeeOriginRegion||"",brewMethod:r.brewMethod||"",tastingNotes:r.tastingNotes||[],acidity:r.acidity||"",mouthFeel:r.mouthFeel||"",roastLevel:r.roastLevel||"",rating:r.rating||3,notes:r.notes||"",isPublic:r.isPublic!==void 0?r.isPublic:!0,coffeeName:r.coffeeName||""}),d=c(e=>e.cafes),C=c(e=>e.setCafes),i=c(e=>e.options),N=c(e=>e.setOptions),u=c(e=>e.fetchError),f=c(e=>e.setFetchError);c(e=>e.user),L.useEffect(()=>{const e=async()=>{try{const o=await P("/metadata/form-options");C(o.cafes||[]),N(o.enums||{})}catch(o){console.error("Error fetching metadata:",o),f("Failed to load metadata")}};(!d||d.length===0)&&e()},[C,N,f,d]);const l=e=>{const{name:o,value:n,type:g,checked:b}=e.target;h(M=>({...M,[o]:g==="checkbox"?b:n})),u&&f("")},O=e=>{const{value:o,checked:n}=e.target;h(g=>({...g,tastingNotes:n?[...g.tastingNotes,o]:g.tastingNotes.filter(b=>b!==o)})),u&&f("")},w=e=>{const o=d.find(n=>n._id===e.target.value);h(n=>({...n,cafeId:e.target.value,cafeNeighborhood:o?o.neighborhood:""}))},I=e=>{if(e.preventDefault(),a.tastingNotes.length===0){f("Please select at least one tasting note.");return}v(a)};return t.jsxs("form",{onSubmit:I,children:[u&&t.jsx(z,{message:u,type:"error"}),t.jsx(s,{label:"Coffee Name",name:"coffeeName",value:a.coffeeName,onChange:l,required:!0,fullWidth:!0,margin:"normal"}),t.jsxs(s,{select:!0,label:"Where did you taste this coffee?",name:"cafeId",value:a.cafeId,onChange:w,required:!0,fullWidth:!0,margin:"normal",children:[t.jsx(m,{value:"",children:"Select a cafe"}),d.map(e=>t.jsx(m,{value:e._id,children:e.name},e._id))]}),t.jsx(s,{label:"Coffee Roaster",name:"coffeeRoaster",value:a.coffeeRoaster,onChange:l,fullWidth:!0,margin:"normal"}),t.jsx(s,{label:"Coffee Origin",name:"coffeeOrigin",value:a.coffeeOrigin,onChange:l,fullWidth:!0,margin:"normal"}),t.jsx(s,{label:"Coffee Region",name:"coffeeOriginRegion",value:a.coffeeOriginRegion,onChange:l,fullWidth:!0,margin:"normal"}),t.jsxs(s,{select:!0,label:"Brew Method",name:"brewMethod",value:a.brewMethod,onChange:l,required:!0,fullWidth:!0,margin:"normal",children:[t.jsx(m,{value:"",children:"Select"}),(i.brewMethod||[]).map(e=>t.jsx(m,{value:e,children:e},e))]}),t.jsxs(x,{fullWidth:!0,margin:"normal",children:[t.jsx(j,{children:"Roast Level"}),t.jsx(s,{type:"range",name:"roastLevel",min:0,max:(F=i.roastLevel)!=null&&F.length?i.roastLevel.length-1:2,value:Math.max(((S=i.roastLevel)==null?void 0:S.indexOf(a.roastLevel))??0,0),onChange:e=>h(o=>{var n;return{...o,roastLevel:((n=i.roastLevel)==null?void 0:n[e.target.value])||""}}),required:!0}),t.jsx(p,{children:a.roastLevel||"Select"})]}),t.jsxs(x,{component:"fieldset",margin:"normal",children:[t.jsx(j,{component:"legend",children:"Tasting Notes (choose multiple):"}),t.jsx(k,{row:!0,children:(i.tastingNotes||[]).map(e=>t.jsx(y,{control:t.jsx(R,{name:"tastingNotes",value:e,checked:a.tastingNotes.includes(e),onChange:O}),label:e},e))})]}),t.jsxs(s,{select:!0,label:"Mouth Feel",name:"mouthFeel",value:a.mouthFeel,onChange:l,required:!0,fullWidth:!0,margin:"normal",children:[t.jsx(m,{value:"",children:"Select"}),(i.mouthFeel||[]).map(e=>t.jsx(m,{value:e,children:e},e))]}),t.jsxs(x,{fullWidth:!0,margin:"normal",children:[t.jsx(j,{component:"legend",children:"Custom icon and color"}),t.jsx(W,{name:"rating",value:a.rating,precision:.5,icon:t.jsx(q,{fontSize:"inherit"}),emptyIcon:t.jsx(T,{fontSize:"inherit"}),onChange:(e,o)=>h(n=>({...n,rating:o}))}),t.jsx(p,{children:a.rating?`${a.rating} Hearts`:"Select rating"})]}),t.jsxs(x,{fullWidth:!0,margin:"normal",children:[t.jsx(j,{component:"legend",children:"10 stars"}),t.jsx(W,{name:"customized-10",value:a.rating,max:10,onChange:(e,o)=>h(n=>({...n,rating:o}))}),t.jsx(p,{children:a.rating?`${a.rating} Stars`:"Select rating"})]}),t.jsx(s,{label:"Notes",name:"notes",value:a.notes,onChange:l,multiline:!0,rows:3,fullWidth:!0,margin:"normal",inputProps:{maxLength:500},placeholder:"Additional notes about the tasting"}),t.jsx(y,{control:t.jsx(R,{id:"isPublic",name:"isPublic",checked:a.isPublic,onChange:l}),label:"Public"}),t.jsx(A,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},disabled:!a.cafeId||!a.coffeeName||!a.brewMethod||!a.roastLevel,children:"Submit"})]})};export{H as T};
