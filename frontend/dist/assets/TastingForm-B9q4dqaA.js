import{r as T,j as e}from"./react-DGUEUQ3j.js";import{u as x,S as z,a as B,s as q}from"./index-CqTq5UyD.js";import{w as H,P as b,a as m,G as j,b as l,y as d,p as h,B as S,H as M,aj as I,ae as $,ak as D,al as U,am as G,Q as _,U as k,W as E,E as K}from"./mui-DIbYq7Rf.js";const Y=({onSubmit:O,initialValues:o={}})=>{const r=H(),i={"& .MuiOutlinedInput-root":{backgroundColor:r.palette.common.white,minHeight:{xs:56,sm:48},"& fieldset":{borderColor:r.palette.text.primary},"&:hover fieldset":{borderColor:r.palette.primary.main},"&.Mui-focused fieldset":{borderColor:r.palette.primary.main},"& input":{color:r.palette.text.primary,fontSize:{xs:"18px",sm:"16px"}},"& textarea":{color:r.palette.text.primary,fontSize:{xs:"18px",sm:"16px"}}},"& .MuiInputLabel-root":{color:r.palette.text.primary,"&.Mui-focused":{color:r.palette.primary.main}}},v={backgroundColor:r.palette.background.default,borderRadius:2,p:3,mb:2,boxShadow:r.shadows[2],border:`1px solid ${r.palette.divider}`,height:"fit-content"},y={color:r.palette.primary.main,fontWeight:600,mb:2,pb:1,borderBottom:`2px solid ${r.palette.background.default}`},[a,C]=T.useState({cafeId:o.cafeId||"",coffeeName:o.coffeeName||"",coffeeRoaster:o.coffeeRoaster||"",coffeeOrigin:o.coffeeOrigin||"",coffeeOriginRegion:o.coffeeOriginRegion||"",brewMethod:o.brewMethod||"",tastingNotes:o.tastingNotes||[],acidity:o.acidity||"",mouthFeel:o.mouthFeel||"",roastLevel:o.roastLevel||"",rating:o.rating||3,notes:o.notes||"",isPublic:o.isPublic!==void 0?o.isPublic:!0}),w=x(t=>t.cafes),R=x(t=>t.setCafes),p=x(t=>t.options),F=x(t=>t.setOptions),u=x(t=>t.fetchError),f=x(t=>t.setFetchError);T.useEffect(()=>{const t=async()=>{var n;try{const s=await B("/metadata/form-options");R(s.cafes||[]),F(s.enums||{})}catch(s){s.code==="NETWORK_ERROR"||(n=s.message)!=null&&n.includes("fetch")||!s.response?q({title:"Server Unavailable",text:"We couldn't reach the server. Please try again later.",icon:"error"}):f("We couldn't load form options. Please try again.")}};(!w||w.length===0)&&t()},[R,F,f,w]);const c=t=>{const{name:n,value:s,type:g,checked:N}=t.target;C(A=>({...A,[n]:g==="checkbox"?N:s})),u&&f("")},W=t=>{const{value:n,checked:s}=t.target;C(g=>({...g,tastingNotes:s?[...g.tastingNotes,n]:g.tastingNotes.filter(N=>N!==n)})),u&&f("")},P=t=>{C(n=>({...n,cafeId:t.target.value})),u&&f("")},L=t=>{if(t.preventDefault(),a.tastingNotes.length===0){f("Please select at least one tasting note.");return}O(a)};return e.jsxs(b,{elevation:6,sx:{width:"100%",p:{xs:2,sm:3},backgroundColor:r.palette.primary.main,color:r.palette.primary.contrastText,borderRadius:2,boxShadow:5},children:[e.jsx(m,{variant:"h4",component:"h2",align:"center",gutterBottom:!0,sx:{mb:3},children:o.cafeId?"Edit Coffee Tasting":"Add New Coffee Tasting"}),e.jsxs("form",{onSubmit:L,"aria-label":"Coffee Tasting Form",children:[u&&e.jsx(z,{message:u,type:"error"}),e.jsxs(j,{container:!0,spacing:{xs:2,md:3},children:[e.jsx(j,{item:!0,xs:12,lg:6,children:e.jsxs(b,{elevation:3,sx:v,children:[e.jsx(m,{variant:"h6",sx:y,children:"Coffee Details"}),e.jsx(l,{title:"Select the cafe where you tasted this coffee.",placement:"top",arrow:!0,children:e.jsxs(d,{select:!0,label:"Where did you taste this coffee?",name:"cafeId",value:a.cafeId,onChange:P,required:!0,fullWidth:!0,margin:"normal",variant:"outlined","aria-label":"Cafe Location",sx:i,children:[e.jsx(h,{value:"",children:"Select a cafe"}),w.map(t=>e.jsx(h,{value:t._id,children:t.name},t._id))]})}),e.jsx(l,{title:"Enter the name of the coffee.",placement:"top",arrow:!0,children:e.jsx(d,{label:"Coffee Name",name:"coffeeName",value:a.coffeeName,onChange:c,required:!0,fullWidth:!0,margin:"normal",variant:"outlined","aria-label":"Coffee Name",sx:i})}),e.jsx(l,{title:"Enter the name of the coffee roaster.",placement:"top",arrow:!0,children:e.jsx(d,{label:"Coffee Roaster",name:"coffeeRoaster",value:a.coffeeRoaster,onChange:c,fullWidth:!0,margin:"normal",variant:"outlined","aria-label":"Coffee Roaster",sx:i})}),e.jsxs(S,{sx:{display:"flex",gap:1,mt:2},children:[e.jsx(l,{title:"Enter the origin of the coffee.",placement:"top",arrow:!0,children:e.jsx(d,{label:"Coffee Origin",name:"coffeeOrigin",value:a.coffeeOrigin,onChange:c,sx:{flex:1,...i}})}),e.jsx(l,{title:"Enter the region of the coffee.",placement:"top",arrow:!0,children:e.jsx(d,{label:"Region",name:"coffeeOriginRegion",value:a.coffeeOriginRegion,onChange:c,sx:{flex:1,...i}})})]})]})}),e.jsx(j,{item:!0,xs:12,lg:6,children:e.jsxs(b,{elevation:3,sx:v,children:[e.jsx(m,{variant:"h6",sx:y,children:"Taste Profile"}),e.jsxs(S,{sx:{display:"flex",gap:1,mb:2},children:[e.jsx(l,{title:"Select the brew method for the coffee.",placement:"top",arrow:!0,children:e.jsxs(d,{select:!0,label:"Brew Method",name:"brewMethod",value:a.brewMethod,onChange:c,required:!0,sx:{flex:1,...i},children:[e.jsx(h,{value:"",children:"Select"}),(p.brewMethod||[]).map(t=>e.jsx(h,{value:t,children:t},t))]})}),e.jsx(l,{title:"Select the roast level of the coffee.",placement:"top",arrow:!0,children:e.jsxs(d,{select:!0,label:"Roast Level",name:"roastLevel",value:a.roastLevel,onChange:c,sx:{flex:1,...i},children:[e.jsx(h,{value:"",children:"Select"}),(p.roastLevel||[]).map(t=>e.jsx(h,{value:t,children:t},t))]})})]}),e.jsxs(S,{sx:{display:"flex",gap:1,mb:2},children:[e.jsx(l,{title:"Select the acidity level of the coffee.",placement:"top",arrow:!0,children:e.jsxs(d,{select:!0,label:"Acidity",name:"acidity",value:a.acidity,onChange:c,sx:{flex:1,...i},children:[e.jsx(h,{value:"",children:"Select"}),(p.acidity||[]).map(t=>e.jsx(h,{value:t,children:t},t))]})}),e.jsx(l,{title:"How does the coffee feel in your mouth?",placement:"top",arrow:!0,children:e.jsxs(d,{select:!0,label:"Mouth Feel",name:"mouthFeel",value:a.mouthFeel,onChange:c,sx:{flex:1,...i},children:[e.jsx(h,{value:"",children:"Select"}),(p.mouthFeel||[]).map(t=>e.jsx(h,{value:t,children:t},t))]})})]}),e.jsxs(M,{fullWidth:!0,margin:"normal",children:[e.jsx(I,{sx:{fontWeight:600,color:r.palette.text.primary},children:"Overall Rating"}),e.jsx(l,{title:"Rate your overall coffee experience from 1-5 hearts",arrow:!0,placement:"top",children:e.jsx($,{name:"rating",value:a.rating,precision:.5,max:5,icon:e.jsx(U,{fontSize:"inherit"}),emptyIcon:e.jsx(D,{fontSize:"inherit"}),onChange:(t,n)=>C(s=>({...s,rating:n||1})),sx:{mt:1,"& .MuiRating-iconFilled":{color:r.palette.accent.main},"& .MuiRating-iconEmpty":{color:"rgba(0, 0, 0, 0.26)"}},"aria-label":"Overall Rating"})}),e.jsx(G,{sx:{color:r.palette.text.secondary},children:a.rating?`${a.rating} out of 5 hearts`:"Select your rating"})]})]})}),e.jsx(j,{item:!0,xs:12,children:e.jsxs(b,{elevation:3,sx:v,children:[e.jsx(m,{variant:"h6",sx:y,children:"Tasting Notes"}),e.jsxs(M,{fullWidth:!0,required:!0,children:[e.jsx(I,{sx:{fontWeight:600,color:r.palette.text.primary,mb:1},children:"Select at least one tasting note"}),e.jsx(_,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(2, 1fr)",sm:"repeat(3, 1fr)",md:"repeat(4, 1fr)",lg:"repeat(5, 1fr)"},gap:1,mt:1},children:(p.tastingNotes||[]).map(t=>e.jsx(k,{control:e.jsx(E,{name:"tastingNotes",value:t,checked:a.tastingNotes.includes(t),onChange:W,size:"small",sx:{color:r.palette.primary.main,"&.Mui-checked":{color:r.palette.secondary.main}}}),label:e.jsx(m,{variant:"body2",sx:{fontSize:"0.875rem"},children:t}),sx:{backgroundColor:a.tastingNotes.includes(t)?"rgba(25, 118, 210, 0.1)":"rgba(255, 255, 255, 0.8)",borderRadius:1,px:1,py:.5,m:0,border:a.tastingNotes.includes(t)?`1px solid ${r.palette.primary.main}`:"1px solid transparent",transition:"all 0.2s ease","&:hover":{backgroundColor:"rgba(25, 118, 210, 0.05)"}}},t))})]})]})}),e.jsx(j,{item:!0,xs:12,children:e.jsxs(b,{elevation:3,sx:v,children:[e.jsx(m,{variant:"h6",sx:y,children:"Additional Details"}),e.jsx(d,{label:"Additional Notes",name:"notes",value:a.notes,onChange:c,multiline:!0,rows:4,fullWidth:!0,margin:"normal",variant:"outlined","aria-label":"Additional Notes",inputProps:{maxLength:500},placeholder:"Share your thoughts about this coffee experience...",sx:i}),e.jsxs(S,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:3,pt:2,borderTop:`1px solid ${r.palette.divider}`},children:[e.jsx(k,{control:e.jsx(E,{name:"isPublic",checked:a.isPublic,onChange:c,sx:{color:r.palette.primary.main}}),label:"Make this tasting public",sx:{color:r.palette.text.primary}}),e.jsx(l,{title:!a.cafeId||!a.coffeeName||!a.brewMethod||a.tastingNotes.length===0?"Please fill in all required fields":"Submit your experience.",placement:"top",arrow:!0,children:e.jsxs("span",{children:[" ",e.jsx(K,{type:"submit",variant:"contained",size:"large",disabled:!a.cafeId||!a.coffeeName||!a.brewMethod||a.tastingNotes.length===0,sx:{minWidth:160,py:1.5,fontSize:"1.1rem",fontWeight:600},"aria-label":o.cafeId?"Update Tasting":"Add Tasting",children:o.cafeId?"Update Tasting":"Add Tasting"})]})})]})]})})]})]})]})};export{Y as T};
