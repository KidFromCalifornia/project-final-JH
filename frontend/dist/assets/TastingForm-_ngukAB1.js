import{a as s,u as r,j as t}from"./index-vULDxt1o.js";const ee="http://localhost:3001/api",se=({onSubmit:I,initialValues:o={}})=>{var R,O,L,M,w,P;const[h,E]=s.useState(o.cafeId||""),[k,te]=s.useState(o.cafeName||""),[T,A]=s.useState(o.cafeNeighborhood||""),[b,_]=s.useState(o.coffeeRoaster||""),[j,B]=s.useState(o.coffeeOrigin||""),[v,D]=s.useState(o.coffeeOriginRegion||""),[f,U]=s.useState(o.brewMethod||""),[u,W]=s.useState(o.tastingNotes||[]),[g,$]=s.useState(o.acidity||""),[C,z]=s.useState(o.mouthFeel||""),[l,G]=s.useState(o.roastLevel||""),[m,H]=s.useState(o.rating||3),[y,J]=s.useState(o.notes||""),[F,K]=s.useState(o.isPublic!==void 0?o.isPublic:!0),[x,Q]=s.useState(o.coffeeName||""),c=r(e=>e.cafes),S=r(e=>e.setCafes),n=r(e=>e.options),N=r(e=>e.setOptions),p=r(e=>e.fetchError),d=r(e=>e.setFetchError);r(e=>e.user),s.useEffect(()=>{const e=async()=>{try{const i=await(await fetch(`${ee}/metadata/form-options`)).json();S(i.cafes||[]),N(i.enums||{})}catch(a){console.error("Error fetching metadata:",a),d("Failed to load metadata")}};(!c||c.length===0)&&e()},[S,N,d,c]);const X=e=>{const{value:a,checked:i}=e.target;W(q=>i?[...q,a]:q.filter(V=>V!==a)),p&&d("")},Y=e=>{const a=c.find(i=>i._id===e.target.value);if(E(e.target.value),A(a?a.neighborhood:""),!req.params.id||req.params.id==="undefined")return res.status(400).json({error:"Missing or invalid ID"})},Z=e=>{if(e.preventDefault(),u.length===0){d("Please select at least one tasting note.");return}I({cafeName:k,coffeeName:x,cafeId:h,cafeNeighborhood:T,coffeeRoaster:b,coffeeOrigin:j,coffeeOriginRegion:v,brewMethod:f,tastingNotes:u,acidity:g,mouthFeel:C,roastLevel:l,rating:m,notes:y,isPublic:F})};return t.jsxs("form",{onSubmit:Z,children:[p&&t.jsx("p",{style:{color:"red",marginBottom:"1rem"},children:p}),t.jsxs("label",{htmlFor:"coffeeName",children:["Coffee Name:",t.jsx("input",{type:"text",id:"coffeeName",name:"coffeeName",value:x,onChange:e=>Q(e.target.value),required:!0})]}),t.jsxs("label",{htmlFor:"cafeId",children:["Where did you taste this coffee?:",t.jsxs("select",{id:"cafeId",name:"cafeId",value:h,onChange:Y,required:!0,children:[t.jsx("option",{value:"",children:"Select Cafe"}),c.map(e=>t.jsx("option",{value:e._id,children:e.name},e._id))]})]}),t.jsxs("label",{htmlFor:"coffeeRoaster",children:["Coffee Roaster:",t.jsx("input",{type:"text",id:"coffeeRoaster",name:"coffeeRoaster",value:b,onChange:e=>_(e.target.value)})]}),t.jsxs("label",{htmlFor:"coffeeOrigin",children:["Coffee Origin:",t.jsx("input",{type:"text",id:"coffeeOrigin",name:"coffeeOrigin",value:j,onChange:e=>B(e.target.value)})]}),t.jsxs("label",{htmlFor:"coffeeOriginRegion",children:["Coffee Region:",t.jsx("input",{type:"text",id:"coffeeOriginRegion",name:"coffeeOriginRegion",value:v,onChange:e=>D(e.target.value)})]}),t.jsxs("label",{htmlFor:"brewMethod",children:["Brew Method:",t.jsxs("select",{id:"brewMethod",name:"brewMethod",value:f,onChange:e=>U(e.target.value),required:!0,children:[t.jsx("option",{value:"",children:"Select"}),(R=n.brewMethod)==null?void 0:R.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsxs("label",{htmlFor:"roastLevel",children:["Roast Level:",t.jsx("input",{type:"range",id:"roastLevel",name:"roastLevel",min:"0",max:(O=n.roastLevel)!=null&&O.length?n.roastLevel.length-1:2,value:Math.max(((L=n.roastLevel)==null?void 0:L.indexOf(l))??0,0),onChange:e=>{var a;return G(((a=n.roastLevel)==null?void 0:a[e.target.value])||"")},required:!0}),t.jsx("span",{style:{marginLeft:"1rem"},children:l||"Select"})]}),t.jsxs("fieldset",{children:[t.jsx("legend",{children:"Tasting Notes (choose multiple):"}),(n.tastingNotes||[]).map(e=>t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",name:"tastingNotes",value:e,checked:u.includes(e),onChange:X}),e]},e))]}),t.jsxs("label",{htmlFor:"acidity",children:["Acidity:",t.jsx("input",{type:"range",id:"acidity",name:"acidity",min:"0",max:(M=n.acidity)!=null&&M.length?n.acidity.length-1:2,value:((w=n.acidity)==null?void 0:w.indexOf(g))??1,onChange:e=>{var a;return $(((a=n.acidity)==null?void 0:a[e.target.value])||"")},required:!0}),t.jsx("span",{style:{marginLeft:"1rem"},children:g||"Select"})]}),t.jsxs("label",{htmlFor:"mouthFeel",children:["Mouth Feel:",t.jsxs("select",{id:"mouthFeel",name:"mouthFeel",value:C,onChange:e=>z(e.target.value),required:!0,children:[t.jsx("option",{value:"",children:"Select"}),(P=n.mouthFeel)==null?void 0:P.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsxs("label",{htmlFor:"rating",children:["Rating (1-5):",t.jsx("input",{type:"range",id:"rating",name:"rating",min:"1",max:"5",value:m,onChange:e=>H(Number(e.target.value)),required:!0}),t.jsx("span",{style:{marginLeft:"1rem"},children:m})]}),t.jsxs("label",{labelhtmlFor:"notes",children:["Notes:",t.jsx("textarea",{id:"notes",name:"notes",value:y,onChange:e=>J(e.target.value),maxLength:500,placeholder:"Additional notes about the tasting"})]}),t.jsxs("label",{htmlFor:"isPublic",children:["Public:",t.jsx("input",{type:"checkbox",id:"isPublic",name:"isPublic",checked:F,onChange:e=>K(e.target.checked)})]}),t.jsx("button",{style:{marginTop:"1rem",backgroundColor:"#170351",color:"#fff",padding:"0.5rem 1rem",border:"none",cursor:"pointer"},type:"submit",disabled:!h||!x||!f||!l,children:"Submit"})]})};export{se as T};
