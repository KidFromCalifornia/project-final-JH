import{j as t,r as L}from"./react-BgOkdmvB.js";import{u as c,a as P}from"./index-BL_xT_vF.js";import"./vendor-BW800UVn.js";import{A as E,e as s,d as f,V as x,W as j,X as p,Y as k,Z as R,_ as W,$ as C,a0 as T,a1 as q,f as A,s as _}from"./mui-CChiYMRS.js";const z=({message:v,type:r="info"})=>t.jsx(E,{severity:r,sx:{my:2},children:v});_(C)({"& .MuiRating-iconFilled":{color:"#ff6d75"},"& .MuiRating-iconHover":{color:"#ff3d47"}});const G=({onSubmit:v,initialValues:r={}})=>{var S,y;const[o,d]=L.useState({cafeId:r.cafeId||"",cafeName:r.cafeName||"",cafeNeighborhood:r.cafeNeighborhood||"",coffeeRoaster:r.coffeeRoaster||"",coffeeOrigin:r.coffeeOrigin||"",coffeeOriginRegion:r.coffeeOriginRegion||"",brewMethod:r.brewMethod||"",tastingNotes:r.tastingNotes||[],acidity:r.acidity||"",mouthFeel:r.mouthFeel||"",roastLevel:r.roastLevel||"",rating:r.rating||3,notes:r.notes||"",isPublic:r.isPublic!==void 0?r.isPublic:!0,coffeeName:r.coffeeName||""}),h=c(e=>e.cafes),N=c(e=>e.setCafes),i=c(e=>e.options),F=c(e=>e.setOptions),u=c(e=>e.fetchError),m=c(e=>e.setFetchError);c(e=>e.user),L.useEffect(()=>{const e=async()=>{try{const a=await P("/metadata/form-options");N(a.cafes||[]),F(a.enums||{})}catch(a){console.error("Error fetching metadata:",a),m("Failed to load metadata")}};(!h||h.length===0)&&e()},[N,F,m,h]);const l=e=>{const{name:a,value:n,type:g,checked:b}=e.target;d(I=>({...I,[a]:g==="checkbox"?b:n})),u&&m("")},M=e=>{const{value:a,checked:n}=e.target;d(g=>({...g,tastingNotes:n?[...g.tastingNotes,a]:g.tastingNotes.filter(b=>b!==a)})),u&&m("")},O=e=>{const a=h.find(n=>n._id===e.target.value);d(n=>({...n,cafeId:e.target.value,cafeNeighborhood:a?a.neighborhood:""}))},w=e=>{if(e.preventDefault(),o.tastingNotes.length===0){m("Please select at least one tasting note.");return}v(o)};return t.jsxs("form",{onSubmit:w,children:[u&&t.jsx(z,{message:u,type:"error"}),t.jsx(s,{label:"Coffee Name",name:"coffeeName",value:o.coffeeName,onChange:l,required:!0,fullWidth:!0,margin:"normal"}),t.jsxs(s,{select:!0,label:"Where did you taste this coffee?",name:"cafeId",value:o.cafeId,onChange:O,required:!0,fullWidth:!0,margin:"normal",children:[t.jsx(f,{value:"",children:"Select a cafe"}),h.map(e=>t.jsx(f,{value:e._id,children:e.name},e._id))]}),t.jsx(s,{label:"Coffee Roaster",name:"coffeeRoaster",value:o.coffeeRoaster,onChange:l,fullWidth:!0,margin:"normal"}),t.jsx(s,{label:"Coffee Origin",name:"coffeeOrigin",value:o.coffeeOrigin,onChange:l,fullWidth:!0,margin:"normal"}),t.jsx(s,{label:"Coffee Region",name:"coffeeOriginRegion",value:o.coffeeOriginRegion,onChange:l,fullWidth:!0,margin:"normal"}),t.jsxs(s,{select:!0,label:"Brew Method",name:"brewMethod",value:o.brewMethod,onChange:l,required:!0,fullWidth:!0,margin:"normal",children:[t.jsx(f,{value:"",children:"Select"}),(i.brewMethod||[]).map(e=>t.jsx(f,{value:e,children:e},e))]}),t.jsxs(x,{fullWidth:!0,margin:"normal",children:[t.jsx(j,{children:"Roast Level"}),t.jsx(s,{type:"range",name:"roastLevel",min:0,max:(S=i.roastLevel)!=null&&S.length?i.roastLevel.length-1:2,value:Math.max(((y=i.roastLevel)==null?void 0:y.indexOf(o.roastLevel))??0,0),onChange:e=>d(a=>{var n;return{...a,roastLevel:((n=i.roastLevel)==null?void 0:n[e.target.value])||""}}),required:!0}),t.jsx(p,{children:o.roastLevel||"Select"})]}),t.jsxs(x,{component:"fieldset",margin:"normal",children:[t.jsx(j,{component:"legend",children:"Tasting Notes (choose multiple):"}),t.jsx(k,{row:!0,children:(i.tastingNotes||[]).map(e=>t.jsx(R,{control:t.jsx(W,{name:"tastingNotes",value:e,checked:o.tastingNotes.includes(e),onChange:M}),label:e},e))})]}),t.jsxs(s,{select:!0,label:"Mouth Feel",name:"mouthFeel",value:o.mouthFeel,onChange:l,required:!0,fullWidth:!0,margin:"normal",children:[t.jsx(f,{value:"",children:"Select"}),(i.mouthFeel||[]).map(e=>t.jsx(f,{value:e,children:e},e))]}),t.jsxs(x,{fullWidth:!0,margin:"normal",children:[t.jsx(j,{component:"legend",children:"Custom icon and color"}),t.jsx(C,{name:"rating",value:o.rating,precision:.5,icon:t.jsx(q,{fontSize:"inherit"}),emptyIcon:t.jsx(T,{fontSize:"inherit"}),onChange:(e,a)=>d(n=>({...n,rating:a}))}),t.jsx(p,{children:o.rating?`${o.rating} Hearts`:"Select rating"})]}),t.jsxs(x,{fullWidth:!0,margin:"normal",children:[t.jsx(j,{component:"legend",children:"10 stars"}),t.jsx(C,{name:"customized-10",value:o.rating,max:10,onChange:(e,a)=>d(n=>({...n,rating:a}))}),t.jsx(p,{children:o.rating?`${o.rating} Stars`:"Select rating"})]}),t.jsx(s,{label:"Notes",name:"notes",value:o.notes,onChange:l,multiline:!0,rows:3,fullWidth:!0,margin:"normal",inputProps:{maxLength:500},placeholder:"Additional notes about the tasting"}),t.jsx(R,{control:t.jsx(W,{id:"isPublic",name:"isPublic",checked:o.isPublic,onChange:l}),label:"Public"}),t.jsx(A,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},disabled:!o.cafeId||!o.coffeeName||!o.brewMethod||!o.roastLevel,children:"Submit"})]})};export{G as T};
