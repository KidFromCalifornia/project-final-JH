import{r as y,j as s}from"./react-BgOkdmvB.js";import{T as L}from"./TastingForm-GoX3MeZO.js";import{u as i}from"./index-BL_xT_vF.js";import{B as I,T as t,Q as P,A as m,q as v,L as S,p as T,f as U}from"./mui-CChiYMRS.js";import"./maplibre-DP_z0KZa.js";import"./vendor-BW800UVn.js";import"./zustand-qHyWAopT.js";const h="https://project-final-ip111vjub-kidfromcalifornias-projects.vercel.app/api",N=()=>{const u=i(e=>e.tastings),x=i(e=>e.setTastings),r=i(e=>e.editingTasting),g=i(e=>e.setEditingTasting),p=i(e=>e.userSubmissions),c=i(e=>e.setUserSubmissions),d=i(e=>e.isLoggedIn),f=i(e=>e.username),[A,j]=y.useState(!1);y.useEffect(()=>{(async()=>{if(d){j(!0);const o=await(await fetch(`${h}/cafeSubmissions/my-submissions`,{headers:{Authorization:`Bearer ${i.getState().userToken}`}})).json();c(o.data||[]),j(!1)}else c([])})()},[d,c]);const B=e=>{const a=r?"PUT":"POST",o=r?`${h}/tastings/${r._id}`:`${h}/tastings`;fetch(o,{method:a,headers:{"Content-Type":"application/json",Authorization:`Bearer ${i.getState().userToken}`},body:JSON.stringify(e)}).then(n=>n.json()).then(n=>{n.success?r?(x(l=>l.map(b=>b._id===r._id?n.data:b)),g(null)):x(l=>[n.data,...l]):console.error("Failed to submit tasting:",n.error)}).catch(n=>console.error("Error submitting tasting:",n))};return A?s.jsx(I,{textAlign:"center",mt:4,children:s.jsx(t,{children:"Loading tastings..."})}):s.jsxs(P,{maxWidth:"md",sx:{mt:4,mb:4},children:[s.jsx(t,{variant:"h4",gutterBottom:!0,children:f?`${f}'s Page`:"User Page"}),s.jsx(t,{variant:"h5",gutterBottom:!0,children:"Your Cafe Submissions"}),p.length===0?s.jsx(m,{severity:"info",children:"No pending submissions."}):s.jsx(v,{children:p.map(e=>s.jsxs(S,{sx:{flexDirection:"column",alignItems:"flex-start",mb:2},children:[s.jsx(t,{variant:"subtitle1",fontWeight:"bold",children:e.name}),s.jsx(t,{variant:"body2",children:e.description}),s.jsxs(t,{variant:"caption",color:"text.secondary",children:[e.category," â€” ",e.isApproved?"Approved":"Pending"]})]},e._id))}),s.jsx(T,{sx:{my:3}}),s.jsx(t,{variant:"h5",gutterBottom:!0,children:"Whatcha Drinking?"}),d?s.jsx(L,{onSubmit:B,initialValues:r||{}}):s.jsx(m,{severity:"warning",sx:{my:2},children:"Please log in to add your own experience"}),s.jsx(T,{sx:{my:3}}),u.length===0?s.jsx(m,{severity:"info",children:"Nothing to see here ðŸ˜ž"}):s.jsx(v,{children:u.map(e=>{var a,o;return s.jsxs(S,{sx:{flexDirection:"column",alignItems:"flex-start",mb:2,borderBottom:"1px solid #eee",pb:2},children:[s.jsx(t,{variant:"subtitle1",fontWeight:"bold",children:e.coffeeName}),s.jsxs(t,{variant:"body2",children:["at ",s.jsx("em",{children:(a=e.cafeId)==null?void 0:a.name})]}),s.jsxs(t,{variant:"body2",children:["Rating: ",e.rating,"/5"]}),s.jsx(t,{variant:"body2",children:e.notes}),s.jsxs(t,{variant:"caption",color:"text.secondary",children:[(o=e.userId)==null?void 0:o.username," â€¢"," ",new Date(e.createdAt).toLocaleDateString()]}),s.jsx(U,{size:"small",variant:"outlined",sx:{mt:1},onClick:()=>g(e),children:"Edit"})]},e._id)})})]})};export{N as default};
